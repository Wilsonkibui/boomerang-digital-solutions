{% extends 'store/base.html' %}
{% load static %}

{% block title %}Checkout - Boomerang Digital Solutions{% endblock %}

{% block content %}
<div class="container py-8">
    <h1 style="margin-bottom: var(--space-8);">Checkout</h1>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-12);">
        <!-- Checkout Form -->
        <div>
            <div
                style="background: var(--white); border: 1px solid var(--light-grey); border-radius: var(--radius-lg); padding: var(--space-8);">
                <h2 style="margin-bottom: var(--space-6);">Delivery Information</h2>

                <form method="POST" action="{% url 'checkout' %}">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="customer_name" class="form-label">Full Name *</label>
                        <input type="text" id="customer_name" name="customer_name" class="form-input" required
                            placeholder="Your full name">
                    </div>

                    <div class="form-group">
                        <label for="phone" class="form-label">Phone Number *</label>
                        <input type="tel" id="phone" name="phone" class="form-input" required placeholder="0712345678">
                        <div class="form-help">We'll contact you on this number for delivery coordination</div>
                    </div>

                    <div class="form-group">
                        <label for="location" class="form-label">Delivery Location *</label>
                        <input type="text" id="location" name="location" class="form-input" required
                            placeholder="e.g. Westlands, Nairobi">
                        <div class="form-help">Area and nearest landmark</div>
                    </div>

                    <div class="form-group">
                        <label for="notes" class="form-label">Additional Notes (Optional)</label>
                        <textarea id="notes" name="notes" class="form-textarea" rows="4"
                            placeholder="Any special delivery instructions or questions..."></textarea>
                    </div>

                    <div style="margin-top: var(--space-8); margin-bottom: var(--space-6);">
                        <h3 style="margin-bottom: var(--space-4);">Payment Method (Placeholder)</h3>

                        <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                            <label
                                style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-4); border: 1px solid var(--border-grey); border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="payment_method" value="mpesa" checked>
                                <div>
                                    <div style="font-weight: 600;">M-Pesa (Manual)</div>
                                    <div style="font-size: var(--text-sm); color: var(--medium-grey);">Pay to Paybill
                                        after order confirmation</div>
                                </div>
                            </label>

                            <label
                                style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-4); border: 1px solid var(--border-grey); border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s;">
                                <input type="radio" name="payment_method" value="cod">
                                <div>
                                    <div style="font-weight: 600;">Cash on Delivery</div>
                                    <div style="font-size: var(--text-sm); color: var(--medium-grey);">Pay upon
                                        receiving your items</div>
                                </div>
                            </label>

                            <label
                                style="display: flex; align-items: center; gap: var(--space-3); padding: var(--space-4); border: 1px solid var(--border-grey); border-radius: var(--radius-md); cursor: pointer; opacity: 0.7;">
                                <input type="radio" name="payment_method" value="card" disabled>
                                <div>
                                    <div style="font-weight: 600;">Credit/Debit Card</div>
                                    <div style="font-size: var(--text-sm); color: var(--medium-grey);">Coming Soon</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg" style="width: 100%;">
                        Complete Order
                    </button>
                    <p
                        style="text-align: center; margin-top: var(--space-2); font-size: var(--text-sm); color: var(--medium-grey);">
                        You will be redirected to the order confirmation page.
                    </p>
                </form>
            </div>
        </div>

        <!-- Order Summary -->
        <div>
            <div
                style="background: var(--off-white); border-radius: var(--radius-lg); padding: var(--space-8); position: sticky; top: 100px;">
                <h2 style="margin-bottom: var(--space-6);">Order Summary</h2>

                <!-- Cart Items -->
                <div style="margin-bottom: var(--space-6);">
                    {% for item in cart_items %}
                    <div
                        style="display: flex; gap: var(--space-3); margin-bottom: var(--space-4); padding-bottom: var(--space-4); border-bottom: 1px solid var(--light-grey);">
                        {% if item.product.image %}
                        <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                            style="width: 60px; height: 60px; object-fit: cover; border-radius: var(--radius-md);">
                        {% else %}
                        <div
                            style="width: 60px; height: 60px; background: var(--off-white); border-radius: var(--radius-md);">
                        </div>
                        {% endif %}

                        <div style="flex: 1;">
                            <div style="font-weight: var(--font-weight-medium); margin-bottom: var(--space-1);">
                                {{ item.product.name }}
                            </div>
                            <div style="color: var(--medium-grey); font-size: var(--text-sm);">
                                Qty: {{ item.quantity }} Ã— KES {{ item.product.price }}
                            </div>
                        </div>

                        <div style="font-weight: var(--font-weight-semibold);">
                            KES {{ item.subtotal }}
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <!-- Totals -->
                <div style="border-top: 2px solid var(--border-grey); padding-top: var(--space-4);">
                    <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-2);">
                        <span style="color: var(--dark-grey);">Subtotal</span>
                        <span>KES {{ total }}</span>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; margin-bottom: var(--space-4); font-size: var(--text-sm); color: var(--medium-grey);">
                        <span>Delivery</span>
                        <span>To be confirmed</span>
                    </div>

                    <div
                        style="display: flex; justify-content: space-between; font-size: var(--text-2xl); font-weight: var(--font-weight-bold); margin-top: var(--space-4);">
                        <span>Total</span>
                        <span style="color: var(--primary-blue);">KES {{ total }}</span>
                    </div>
                </div>

                <div class="alert alert-info" style="margin-top: var(--space-6); font-size: var(--text-sm);">
                    <strong>Note:</strong> Delivery fee will be calculated based on your location and confirmed via
                    WhatsApp.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}